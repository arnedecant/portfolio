import{z,I as R,J as K,K as b,L as W,M as k,N as B,O as j,P as H,T as V,Q as J,c as Q,u as G,C as X,D as Y,p as Z,B as w,R as ee,_ as te}from"./juQNaY-B.js";import{p as D,k as F,t as ne}from"./BzJ09L6G.js";import{c as I,a as T,b as re,f as oe,h as se}from"./B9L86aWK.js";function ae(e,n){return n.reduce((t,o)=>{const r=ue(e,o);return r!==void 0&&(t[o]=r),t},{})}function ue(e,n){return n.split(".").reduce((t,o)=>t&&t[o],e)}const x="default",$=/^@|^v-on:/,A=/^:|^v-bind:/,ce=/^v-model/,ie=["select","textarea","input"],pe=["math","svg"],le=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(e=>[e,`prose-${e}`])),fe=["script","base"],de=z({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},class:{type:[String,Object],default:void 0},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})},unwrap:{type:[Boolean,String],default:!1}},async setup(e){const t=K()?.appContext?.app?.$nuxt,o=t?.$route||t?._route,{mdc:r}=t?.$config?.public||{},a=b(()=>({...r?.components?.prose&&e.prose!==!1?le:{},...r?.components?.map||{},...H(e.data?.mdc?.components||{}),...e.components})),l=b(()=>{const u=(e.body?.children||[]).map(c=>c.tag||c.type).filter(c=>!T.includes(c));return Array.from(new Set(u)).sort().join(".")}),i=W({...e.data});k(()=>e.data,u=>{Object.assign(i,u)}),await Te(e.body,{tags:a.value});function p(u,c){const d=u.split(".").length-1;return u.split(".").reduce((g,v,h)=>h==d&&g?(g[v]=c,g[v]):typeof g=="object"?g[v]:void 0,i)}return{tags:a,contentKey:l,route:o,runtimeData:i,updateRuntimeData:p}},render(e){const{tags:n,tag:t,body:o,data:r,contentKey:a,route:l,unwrap:i,runtimeData:p,updateRuntimeData:u}=e;if(!o)return null;const c={...r,tags:n,$route:l,runtimeData:p,updateRuntimeData:u},d=t!==!1?S(t||c.component?.name||c.component||"div"):void 0;return d?R(d,{...c.component?.props,class:e.class,...this.$attrs,key:a},{default:g}):g?.();function g(){const v=M(o,R,{documentMeta:c,parentScope:c,resolveComponent:S});return v?.default?i?I(v.default(),typeof i=="string"?i.split(" "):["*"]):v.default():null}}});function me(e,n,t,o){const{documentMeta:r,parentScope:a,resolveComponent:l}=t;if(e.type==="text")return n(V,e.value);if(e.type==="comment")return n(J,null,e.value);const i=e.tag,p=L(e,r.tags);if(e.tag==="binding")return ge(e,n,r,a);const u=N(p)?g=>g:l;if(fe.includes(p))return n("pre",{class:"mdc-renderer-dangerous-tag"},"<"+p+">"+re(e)+"</"+p+">");const c=u(p);typeof c=="object"&&(c.tag=i);const d=ve(e,r);return o&&(d.key=o),n(c,d,M(e,n,{documentMeta:r,parentScope:{...a,...d},resolveComponent:u}))}function M(e,n,t){const{documentMeta:o,parentScope:r,resolveComponent:a}=t,i=(e.children||[]).reduce((u,c)=>{if(!De(c))return u[x].children.push(c),u;const d=he(c);return u[d]=u[d]||{props:{},children:[]},c.type==="element"&&(u[d].props=c.props,u[d].children.push(...c.children||[])),u},{[x]:{props:{},children:[]}});return Object.entries(i).reduce((u,[c,{props:d,children:g}])=>(g.length&&(u[c]=(v={})=>{const h=ae(v,Object.keys(d||{}));let C=g.map((s,f)=>me(s,n,{documentMeta:o,parentScope:{...r,...h},resolveComponent:a},String(s.props?.key||f)));return d?.unwrap&&(C=I(C,d.unwrap)),Ce(C)}),u),{})}function ge(e,n,t,o={}){const r={...t.runtimeData,...o,$document:t,$doc:t},a=/\.|\[(\d+)\]/,i=(e.props?.value.trim().split(a).filter(Boolean)).reduce((u,c)=>{if(u&&c in u)return typeof u[c]=="function"?u[c]():u[c]},r),p=e.props?.defaultValue;return n(V,i??p??"")}function ve(e,n){const{tag:t="",props:o={}}=e;return Object.keys(o).reduce(function(r,a){if(a==="__ignoreMap")return r;const l=o[a];if(ce.test(a))return ye(a,l,r,n,{native:ie.includes(t)});if(a==="v-bind")return _e(a,l,r,n);if($.test(a))return Pe(a,l,r,n);if(A.test(a))return be(a,l,r,n);const{attribute:i}=oe(se,a);return Array.isArray(l)&&l.every(p=>typeof p=="string")?(r[i]=l.join(" "),r):(r[i]=l,r)},{})}function ye(e,n,t,o,{native:r}){const a=e.match(/^v-model:([^=]+)/)?.[1]||"modelValue",l=r?"value":a,i=r?"onInput":`onUpdate:${a}`;return t[l]=O(n,o.runtimeData),t[i]=p=>{o.updateRuntimeData(n,r?p.target?.value:p)},t}function _e(e,n,t,o){const r=O(n,o);return t=Object.assign(t,r),t}function Pe(e,n,t,o){return e=e.replace($,""),t.on=t.on||{},t.on[e]=()=>O(n,o),t}function be(e,n,t,o){return e=e.replace(A,""),t[e]=O(n,o),t}const S=e=>{if(typeof e=="string"){if(T.includes(e))return e;const n=B(D(e),!1);return!e||n?.name==="AsyncComponentWrapper"||typeof n=="string"?n:"setup"in n?j(()=>new Promise(t=>t(n))):n}return e};function O(e,n){const t=e.split(".").reduce((o,r)=>typeof o=="object"?o[r]:void 0,n);return typeof t>"u"?Q(e):t}function he(e){let n="";for(const t of Object.keys(e.props||{}))if(!(!t.startsWith("#")&&!t.startsWith("v-slot:"))){n=t.split(/[:#]/,2)[1];break}return n||x}function De(e){return e.tag==="template"}function N(e){return pe.includes(e)}function Ce(e){const n=[];for(const t of e){const o=n[n.length-1];t.type===V&&o?.type===V?o.children=o.children+t.children:n.push(t)}return n}async function Te(e,n){if(!e)return;const t=Array.from(new Set(o(e,n)));await Promise.all(t.map(async r=>{if(r?.render||r?.ssrRender||r?.__ssrInlineRender)return;const a=S(r);a?.__asyncLoader&&!a.__asyncResolved&&await a.__asyncLoader()}));function o(r,a){const l=r.tag;if(r.type==="text"||l==="binding"||r.type==="comment")return[];const i=L(r,a.tags);if(N(i))return[];const p=[];r.type!=="root"&&!T.includes(i)&&p.push(i);for(const u of r.children||[])p.push(...o(u,a));return p}}function L(e,n){const t=e.tag;return!t||typeof e.props?.__ignoreMap<"u"?t:n[t]||n[D(t)]||n[F(e.tag)]||t}const Ve=Object.assign(de,{__name:"MDCRenderer"}),E=["ProseADVue","ProseA","ProseBlockquoteDVue","ProseBlockquote","ProseCodeDVue","ProseCode","ProseEmDVue","ProseEm","ProseH1DVue","ProseH1","ProseH2DVue","ProseH2","ProseH3DVue","ProseH3","ProseH4DVue","ProseH4","ProseH5DVue","ProseH5","ProseH6DVue","ProseH6","ProseHrDVue","ProseHr","ProseImgDVue","ProseImg","ProseLiDVue","ProseLi","ProseOlDVue","ProseOl","ProsePDVue","ProseP","ProsePreDVue","ProsePre","ProseScriptDVue","ProseScript","ProseStrongDVue","ProseStrong","ProseTableDVue","ProseTable","ProseTbodyDVue","ProseTbody","ProseTdDVue","ProseTd","ProseThDVue","ProseTh","ProseTheadDVue","ProseThead","ProseTrDVue","ProseTr","ProseUlDVue","ProseUl","Icon"],q=[],Oe=Object.freeze(Object.defineProperty({__proto__:null,globalComponents:E,localComponents:q},Symbol.toStringTag,{value:"Module"})),je={__name:"ContentRenderer",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},prose:{type:Boolean,default:void 0},class:{type:[String,Object],default:void 0},unwrap:{type:[Boolean,String],default:!1}},setup(e){const n=["render","ssrRender","__ssrInlineRender"],t=e,o=!0,r=b(()=>{let s=t.value.body||t.value;return t.excerpt&&t.value.excerpt&&(s=t.value.excerpt),s.type==="minimal"||s.type==="minimark"?ne({value:s.value}):s}),a=b(()=>!r.value?.children?.length),l=b(()=>{const{body:s,excerpt:f,...m}=t.value;return{...m,...t.data}}),i=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(s=>[s,`prose-${s}`])),{mdc:p}=G().public||{},u=b(()=>t.data.mdc),c=b(()=>({...p?.components?.prose&&t.prose!==!1?i:{},...p?.components?.map||{},...H(u.value?.components||{}),...t.components})),d=b(()=>r.value?v(r.value,{tags:c.value}):{});function g(s){let f=s;if(typeof s=="string"){if(T.includes(s))return s;if(E.includes(D(s))?f=B(s,!1):q.includes(D(s))&&(f=j(()=>te(()=>Promise.resolve().then(()=>Oe),void 0,import.meta.url).then(y=>{const _=y[D(s)];return _?_():void 0}))),typeof f=="string")return f}if(!f)return f;const m=f;return"__asyncLoader"in m?m:"setup"in m?j(()=>Promise.resolve(m)):m}function v(s,f){if(!s)return;const m=Array.from(new Set(h(s,f))),P={};for(const[y,_]of m)if(!P[y]){if(typeof _=="object"&&n.some(U=>Object.hasOwnProperty.call(_,U))){P[y]=_;continue}P[y]=g(_)}return P}function h(s,f){const m=s.tag;if(s.type==="text"||m==="binding"||s.type==="comment")return[];const P=C(s,f.tags),y=[];s.type!=="root"&&!T.includes(P)&&y.push([m,P]);for(const _ of s.children||[])y.push(...h(_,f));return y}function C(s,f){const m=s.tag;return!m||typeof s.props?.__ignoreMap<"u"?m:f[m]||f[D(m)]||f[F(s.tag)]||m}return(s,f)=>a.value?Y(s.$slots,"empty",{key:1,body:r.value,data:l.value,dataContentId:w(o)?e.value.id:void 0}):(Z(),X(Ve,{key:0,body:r.value,data:l.value,class:ee(t.class),tag:t.tag,prose:t.prose,unwrap:t.unwrap,components:d.value,"data-content-id":w(o)?e.value.id:void 0},null,8,["body","data","class","tag","prose","unwrap","components","data-content-id"]))}},we=Object.assign(je,{__name:"ContentRenderer"});export{we as _};
